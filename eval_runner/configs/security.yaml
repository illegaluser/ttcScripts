description: "Fail-Fast Policy checks (PII/Secret patterns)"

providers:
  - id: echo
    config: {}

prompts:
  - "{{ prompt }}"

tests:
  # 주민등록번호 패턴 (예: 900101-1234567)
  - vars:
      name: "policy_violation_rrn"
    assert:
      - type: not-contains-regex
        value: "\\b\\d{6}-\\d{7}\\b"

  # 국내 휴대폰 번호 패턴 (예: 010-1234-5678 / 011-123-4567)
  - vars:
      name: "policy_violation_phone"
    assert:
      - type: not-contains-regex
        value: "\\b01[016789]-\\d{3,4}-\\d{4}\\b"

  # API KEY/SECRET 노출 패턴(보수적 탐지)
  - vars:
      name: "policy_violation_secret"
    assert:
      - type: not-contains-regex
        value: "(?i)(api[_-]?key|secret|token)\\s*[:=]\\s*[A-Za-z0-9_\\-]{16,}"